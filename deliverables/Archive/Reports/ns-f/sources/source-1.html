


<!DOCTYPE html>
<html id="htmlId">
<head>
  <meta http-equiv="Content-Type" content="text/html;charset=windows-1252"> 
  <title>Coverage Report > GuiController</title>
  <style type="text/css">
    @import "../../css/coverage.css";
    @import "../../css/idea.min.css";
  </style>
  <script type="text/javascript" src="../../js/highlight.min.js"></script>
  <script type="text/javascript" src="../../js/highlightjs-line-numbers.min.js"></script>
</head>

<body>
<div class="content">
<div class="breadCrumbs">
Current scope:     <a href="../../index.html">all classes</a>
    <span class="separator">|</span>
    <a href="../index.html">codex.lb04.View.Gui</a>
</div>

<h1>Coverage Summary for Class: GuiController (codex.lb04.View.Gui)</h1>

<table class="coverageStats">
<tr>
  <th class="name">Class</th>
<th class="coverageStat 
">
  Class, %
</th>
<th class="coverageStat 
">
  Method, %
</th>
<th class="coverageStat 
">
  Branch, %
</th>
<th class="coverageStat 
">
  Line, %
</th>
</tr>
<tr>
  <td class="name">GuiController</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/70)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/64)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/242)
  </span>
</td>
</tr>

</table>

<br/>
<br/>


<pre>
<code class="sourceCode" id="sourceCode">&nbsp;package codex.lb04.View.Gui;
&nbsp;
&nbsp;import codex.lb04.Message.GameMessage.*;
&nbsp;import codex.lb04.Model.*;
&nbsp;import codex.lb04.Network.client.ClientSocket;
&nbsp;import codex.lb04.View.ViewController;
&nbsp;import javafx.application.Platform;
&nbsp;import javafx.scene.Group;
&nbsp;import javafx.scene.effect.Glow;
&nbsp;import javafx.scene.image.Image;
&nbsp;import javafx.scene.input.ContextMenuEvent;
&nbsp;import javafx.scene.input.MouseEvent;
&nbsp;import javafx.scene.paint.Color;
&nbsp;import javafx.scene.paint.ImagePattern;
&nbsp;import javafx.scene.shape.Rectangle;
&nbsp;import javafx.scene.text.Text;
&nbsp;
&nbsp;import java.io.FileNotFoundException;
&nbsp;import java.io.InputStream;
&nbsp;import java.util.*;
&nbsp;
&nbsp;/**
&nbsp; * Controller class for the GUI view (mainly for the board scene)
&nbsp; */
<b class="nc">&nbsp;public class GuiController extends ViewController {</b>
&nbsp;    private final GuiView guiView;
&nbsp;    private ClientSocket clientSocket;
&nbsp;    //grid map fields
&nbsp;    private Map&lt;Rectangle, Card&gt; gridMap;
&nbsp;
<b class="nc">&nbsp;    private Card selectedCard = null;</b>
<b class="nc">&nbsp;    private Rectangle selectedRectangle = null;</b>
&nbsp;
&nbsp;    private Map&lt;Rectangle, Card&gt; drawableResources;
&nbsp;    private Map&lt;Rectangle, Card&gt; drawableGold;
&nbsp;    private Map&lt;Rectangle, Card&gt; hand;
&nbsp;    private Map&lt;Rectangle, Card&gt; commonObjectives;
&nbsp;    private Map&lt;Rectangle, Card&gt; secretObjectivesToChoose;
&nbsp;    private Map&lt;Rectangle, Card&gt; secretObjective;
&nbsp;    private Map&lt;Rectangle, Card&gt; initialCardDisplay;
&nbsp;    private Map&lt;Rectangle, Text&gt; pointsDisplay;
&nbsp;
&nbsp;    /**
&nbsp;     * Constructor of the board scene controller
&nbsp;     *
&nbsp;     * @param guiView the view
&nbsp;     */
<b class="nc">&nbsp;    public GuiController(GuiView guiView) {</b>
<b class="nc">&nbsp;        this.gridMap = new HashMap&lt;&gt;();</b>
<b class="nc">&nbsp;        this.guiView = guiView;</b>
<b class="nc">&nbsp;        this.drawableResources = new LinkedHashMap&lt;&gt;();</b>
<b class="nc">&nbsp;        this.hand = new LinkedHashMap&lt;&gt;();</b>
<b class="nc">&nbsp;        this.drawableGold = new LinkedHashMap&lt;&gt;();</b>
<b class="nc">&nbsp;        this.commonObjectives = new LinkedHashMap&lt;&gt;();</b>
<b class="nc">&nbsp;        this.secretObjectivesToChoose = new LinkedHashMap&lt;&gt;();</b>
<b class="nc">&nbsp;        this.secretObjective = new LinkedHashMap&lt;&gt;();</b>
<b class="nc">&nbsp;        this.initialCardDisplay = new LinkedHashMap&lt;&gt;();</b>
<b class="nc">&nbsp;        this.pointsDisplay = new LinkedHashMap&lt;&gt;();</b>
&nbsp;
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Method to draw the lobby scene
&nbsp;     */
&nbsp;    @Override
&nbsp;    public void drawLobbyScene() {
<b class="nc">&nbsp;        Platform.runLater(guiView::drawLobbyScene);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Method to draw the hello scene
&nbsp;     */
&nbsp;    @Override
&nbsp;    public void drawHelloScene() {
<b class="nc">&nbsp;        Platform.runLater(guiView::drawHelloScene);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Method to update the lobby
&nbsp;     */
&nbsp;    @Override
&nbsp;    public void updateLobby(ArrayList&lt;String&gt; lobby) {
<b class="nc">&nbsp;        Platform.runLater(()-&gt;guiView.updateLobby(lobby));</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * draws the visible gold cards
&nbsp;     *
&nbsp;     * @param goldCards the gold cards arrayList
&nbsp;     */
&nbsp;    @Override
&nbsp;    public void updateDrawableGold(ArrayList&lt;GoldCard&gt; goldCards) {
<b class="nc">&nbsp;        drawableGold.replaceAll((r, v) -&gt; null);</b>
<b class="nc">&nbsp;        for (Rectangle rectangle : drawableGold.keySet()) {</b>
<b class="nc">&nbsp;            Platform.runLater(() -&gt; cleanImage(rectangle));</b>
&nbsp;        }
<b class="nc">&nbsp;        for (int i = 0; i &lt; goldCards.size(); i++) {</b>
<b class="nc">&nbsp;            GoldCard goldCard = goldCards.get(i);</b>
<b class="nc">&nbsp;            drawableGold.put((Rectangle) drawableGold.keySet().toArray()[i], goldCard);</b>
<b class="nc">&nbsp;            Rectangle rectangle = (Rectangle) drawableGold.keySet().toArray()[i];</b>
<b class="nc">&nbsp;            Platform.runLater(() -&gt; {</b>
&nbsp;                try {
<b class="nc">&nbsp;                    drawDrawableGold(rectangle, goldCard);</b>
<b class="nc">&nbsp;                } catch (FileNotFoundException e) {</b>
<b class="nc">&nbsp;                    System.out.println(&quot;card image for gold card not found&quot;);</b>
&nbsp;                }
&nbsp;            });
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     *  updates the drawable resources
&nbsp;     *
&nbsp;     * @param resourceCards the resource cards arrayList
&nbsp;     */
&nbsp;    @Override
&nbsp;    public void updateDrawableResources(ArrayList&lt;ResourceCard&gt; resourceCards) {
<b class="nc">&nbsp;        drawableResources.replaceAll((r, v) -&gt; null);</b>
<b class="nc">&nbsp;        for (Rectangle rectangle : drawableResources.keySet()) {</b>
<b class="nc">&nbsp;            Platform.runLater(() -&gt; cleanImage(rectangle));</b>
&nbsp;        }
<b class="nc">&nbsp;        for (int i = 0; i &lt; resourceCards.size(); i++) {</b>
<b class="nc">&nbsp;            ResourceCard resourceCard = resourceCards.get(i);</b>
<b class="nc">&nbsp;            drawableResources.put((Rectangle) drawableResources.keySet().toArray()[i], resourceCard);</b>
<b class="nc">&nbsp;            Rectangle rectangle = (Rectangle) drawableResources.keySet().toArray()[i];</b>
<b class="nc">&nbsp;            Platform.runLater(() -&gt; {</b>
&nbsp;                try {
<b class="nc">&nbsp;                    drawDrawableResource(rectangle, resourceCard);</b>
<b class="nc">&nbsp;                } catch (FileNotFoundException e) {</b>
<b class="nc">&nbsp;                    System.out.println(&quot;card image for resource card not found&quot;);</b>
&nbsp;                }
&nbsp;            });
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * updates the hand
&nbsp;     *
&nbsp;     * @param handCards the hand cards arrayList
&nbsp;     */
&nbsp;    @Override
&nbsp;    public void updateHand(ArrayList&lt;Card&gt; handCards) {
<b class="nc">&nbsp;        hand.replaceAll((r, v) -&gt; null);</b>
<b class="nc">&nbsp;        for (Rectangle rectangle : hand.keySet()) {</b>
<b class="nc">&nbsp;            Platform.runLater(() -&gt; cleanImage(rectangle));</b>
&nbsp;        }
<b class="nc">&nbsp;        for (int i = 0; i &lt; handCards.size(); i++) {</b>
<b class="nc">&nbsp;            Card card = handCards.get(i);</b>
<b class="nc">&nbsp;            hand.put((Rectangle) hand.keySet().toArray()[i], card);</b>
<b class="nc">&nbsp;            Rectangle rectangle = (Rectangle) hand.keySet().toArray()[i];</b>
<b class="nc">&nbsp;            Platform.runLater(() -&gt; {</b>
&nbsp;                try {
<b class="nc">&nbsp;                    drawHand(rectangle, card);</b>
<b class="nc">&nbsp;                } catch (FileNotFoundException e) {</b>
<b class="nc">&nbsp;                    System.out.println(&quot;card image for a card in hand not found&quot;);</b>
&nbsp;
&nbsp;                }
&nbsp;            });
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * updates the common objectives
&nbsp;     *
&nbsp;     * @param objectiveCards the objective cards arrayList
&nbsp;     */
&nbsp;    @Override
&nbsp;    public void updateCommonObjectives(ArrayList&lt;ObjectiveCard&gt; objectiveCards) {
<b class="nc">&nbsp;        for (int i = 0; i &lt; objectiveCards.size(); i++) {</b>
<b class="nc">&nbsp;            ObjectiveCard card = objectiveCards.get(i);</b>
<b class="nc">&nbsp;            commonObjectives.put((Rectangle) commonObjectives.keySet().toArray()[i], card);</b>
<b class="nc">&nbsp;            Rectangle rectangle = (Rectangle) commonObjectives.keySet().toArray()[i];</b>
<b class="nc">&nbsp;            Platform.runLater(() -&gt; {</b>
&nbsp;                try {
<b class="nc">&nbsp;                    drawCommonObjectives(rectangle, card);</b>
<b class="nc">&nbsp;                } catch (FileNotFoundException e) {</b>
<b class="nc">&nbsp;                    System.out.println(&quot;card image for objective not found&quot;);</b>
&nbsp;                }
&nbsp;            });
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * updates the initial card display
&nbsp;     *
&nbsp;     * @param card the initial card
&nbsp;     */
&nbsp;    @Override
&nbsp;    public void updateInitialCardDisplay(InitialCard card) {
<b class="nc">&nbsp;        initialCardDisplay.put((Rectangle) initialCardDisplay.keySet().toArray()[0], card);</b>
<b class="nc">&nbsp;        Rectangle rectangle = (Rectangle) initialCardDisplay.keySet().toArray()[0];</b>
<b class="nc">&nbsp;        Platform.runLater(() -&gt; {</b>
&nbsp;            try {
<b class="nc">&nbsp;                drawInitialCardDisplay(rectangle, card);</b>
<b class="nc">&nbsp;            } catch (FileNotFoundException e) {</b>
<b class="nc">&nbsp;                System.out.println(&quot;card image for initial card not found&quot;);</b>
&nbsp;
&nbsp;            }
&nbsp;        });
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * updates the secret objectives to choose
&nbsp;     *
&nbsp;     * @param objectiveCards the objective cards arrayList
&nbsp;     */
&nbsp;    @Override
&nbsp;    public void updateSecretObjectiveToChoose(ArrayList&lt;ObjectiveCard&gt; objectiveCards) {
<b class="nc">&nbsp;        for (int i = 0; i &lt; objectiveCards.size(); i++) {</b>
<b class="nc">&nbsp;            ObjectiveCard card = objectiveCards.get(i);</b>
<b class="nc">&nbsp;            secretObjectivesToChoose.put((Rectangle) secretObjectivesToChoose.keySet().toArray()[i], card);</b>
<b class="nc">&nbsp;            Rectangle rectangle = (Rectangle) secretObjectivesToChoose.keySet().toArray()[i];</b>
<b class="nc">&nbsp;            Platform.runLater(() -&gt; {</b>
&nbsp;                try {
<b class="nc">&nbsp;                    drawSecretObjectivesToChoose(rectangle, card);</b>
<b class="nc">&nbsp;                } catch (FileNotFoundException e) {</b>
<b class="nc">&nbsp;                    System.out.println(&quot;card image for secret objective card not found&quot;);</b>
&nbsp;                }
&nbsp;            });
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * updates the secret objective
&nbsp;     *
&nbsp;     * @param objectiveCard the secret objective card chosen
&nbsp;     */
&nbsp;    @Override
&nbsp;    public void updateSecretObjective(ObjectiveCard objectiveCard) {
<b class="nc">&nbsp;        secretObjective.put((Rectangle) secretObjective.keySet().toArray()[0], objectiveCard);</b>
<b class="nc">&nbsp;        Rectangle rectangle = (Rectangle) secretObjective.keySet().toArray()[0];</b>
&nbsp;
<b class="nc">&nbsp;        Platform.runLater(() -&gt; {</b>
&nbsp;            try {
<b class="nc">&nbsp;                drawSecretObjective(rectangle, objectiveCard);</b>
<b class="nc">&nbsp;            } catch (FileNotFoundException e) {</b>
<b class="nc">&nbsp;                System.out.println(&quot;card image for secret objective card not found&quot;);</b>
&nbsp;            }
&nbsp;        });
&nbsp;
&nbsp;    }
&nbsp;
&nbsp;    public void toggleChat(){
<b class="nc">&nbsp;        Group chatGroup = guiView.getChatGroup();</b>
<b class="nc">&nbsp;        if(chatGroup.isVisible()){</b>
<b class="nc">&nbsp;            Platform.runLater(()-&gt;chatGroup.setVisible(false));</b>
&nbsp;        }else{
<b class="nc">&nbsp;            Platform.runLater(()-&gt;chatGroup.setVisible(true));</b>
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    public void cleanImage(Rectangle rectangle) {
<b class="nc">&nbsp;        rectangle.setFill(Color.BLACK);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Method to place a card on the grid
&nbsp;     *
&nbsp;     * @param x    the x coordinate
&nbsp;     * @param y    the y coordinate
&nbsp;     * @param card the card
&nbsp;     */
&nbsp;    @Override
&nbsp;    public void placeCard(Integer x, Integer y, Card card) {
<b class="nc">&nbsp;        for (Rectangle rectangle : gridMap.keySet()) {</b>
&nbsp;            //noinspection unchecked
<b class="nc">&nbsp;            ArrayList&lt;Integer&gt; coordinates = (ArrayList&lt;Integer&gt;) rectangle.getUserData();</b>
<b class="nc">&nbsp;            Integer X = coordinates.get(0);</b>
<b class="nc">&nbsp;            Integer Y = coordinates.get(1);</b>
<b class="nc">&nbsp;            if (Objects.equals(X, x) &amp;&amp; Objects.equals(Y, y)) {</b>
<b class="nc">&nbsp;                if (x == 0 &amp;&amp; y == 0) {</b>
<b class="nc">&nbsp;                    Rectangle toDisable = (Rectangle) initialCardDisplay.keySet().toArray()[0];</b>
<b class="nc">&nbsp;                    toDisable.setOpacity(0);</b>
<b class="nc">&nbsp;                    toDisable.setHeight(0);</b>
<b class="nc">&nbsp;                    toDisable.setWidth(0);</b>
<b class="nc">&nbsp;                    toDisable.setDisable(true);</b>
<b class="nc">&nbsp;                    guiView.getInitCardBackground().setOpacity(0);</b>
<b class="nc">&nbsp;                    guiView.getInitCardBackground().setHeight(0);</b>
<b class="nc">&nbsp;                    guiView.getInitCardBackground().setWidth(0);</b>
<b class="nc">&nbsp;                    guiView.getInitCardBackground().setDisable(true);</b>
&nbsp;                }
&nbsp;
<b class="nc">&nbsp;                gridMap.put(rectangle, card);</b>
<b class="nc">&nbsp;                rectangle.setOpacity(1);</b>
<b class="nc">&nbsp;                Platform.runLater(() -&gt; {</b>
&nbsp;                    try {
<b class="nc">&nbsp;                        drawGenericCard(rectangle, card);</b>
<b class="nc">&nbsp;                    } catch (FileNotFoundException e) {</b>
<b class="nc">&nbsp;                        System.out.println(&quot;card image for placed card not found&quot;);</b>
&nbsp;                    }
&nbsp;                });
<b class="nc">&nbsp;                Platform.runLater(() -&gt; guiView.bringRectangleToFront(rectangle));</b>
&nbsp;
&nbsp;            }
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Method to deselect a card
&nbsp;     */
&nbsp;    @Override
&nbsp;    public void deselectCard(){
<b class="nc">&nbsp;        if(this.selectedRectangle!= null &amp;&amp; this.selectedCard != null){</b>
<b class="nc">&nbsp;            this.selectedRectangle.setEffect(new Glow(0));</b>
<b class="nc">&nbsp;            this.selectedCard = null;</b>
<b class="nc">&nbsp;            this.selectedRectangle = null;</b>
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Method to display an alert
&nbsp;     *
&nbsp;     * @param alert the alert
&nbsp;     */
&nbsp;    @Override
&nbsp;    public void displayAlert(String alert) {
<b class="nc">&nbsp;        Platform.runLater(()-&gt;guiView.displayAlert(alert));</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Method to draw the board scene
&nbsp;     */
&nbsp;    @Override
&nbsp;    public void drawBoardScene() {
<b class="nc">&nbsp;        guiView.drawBoardScene();</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Method to set the turn text
&nbsp;     */
&nbsp;    @Override
&nbsp;    public void setYourTurnText() {
<b class="nc">&nbsp;        Platform.runLater(()-&gt;guiView.getTurnText().setText(&quot;YOUR TURN&quot;));</b>
&nbsp;
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Method to clean the turn text
&nbsp;     */
&nbsp;    @Override
&nbsp;    public void cleanYourTurnText() {
<b class="nc">&nbsp;        Platform.runLater(()-&gt;guiView.getTurnText().setText(&quot;NOT YOUR TURN&quot;));</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Method to handle the click on the grid
&nbsp;     *
&nbsp;     * @param event the mouse event
&nbsp;     */
&nbsp;    public void onGridClick(MouseEvent event) {
<b class="nc">&nbsp;        if (selectedCard != null &amp;&amp; selectedRectangle != null) {</b>
<b class="nc">&nbsp;            Rectangle clickedRectangle = (Rectangle) event.getSource();</b>
&nbsp;            //noinspection unchecked
<b class="nc">&nbsp;            ArrayList&lt;Integer&gt; coordinates = (ArrayList&lt;Integer&gt;) clickedRectangle.getUserData();</b>
<b class="nc">&nbsp;            Integer X = coordinates.get(0);</b>
<b class="nc">&nbsp;            Integer Y = coordinates.get(1);</b>
<b class="nc">&nbsp;            clientSocket.sendMessage(new PlaceCardMessage(clientSocket.getUsername(), X, Y, selectedCard));</b>
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Method to handle the click on the initial card
&nbsp;     *
&nbsp;     * @param event the context menu event
&nbsp;     */
&nbsp;    public void onInitialCardSelection(ContextMenuEvent event) {
<b class="nc">&nbsp;        Rectangle initCardDisplay = (Rectangle) initialCardDisplay.keySet().toArray()[0];</b>
<b class="nc">&nbsp;        InitialCard initCard = (InitialCard) initialCardDisplay.get(initCardDisplay);</b>
<b class="nc">&nbsp;        clientSocket.sendMessage(new PickInitialCardSideMessage(clientSocket.getUsername(), initCard));</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Method to handle the click on the secret objective
&nbsp;     *
&nbsp;     * @param event the context menu event
&nbsp;     */
&nbsp;    public void onSecretObjectivePick(ContextMenuEvent event) {
<b class="nc">&nbsp;        Rectangle rectangle = (Rectangle) event.getSource();</b>
<b class="nc">&nbsp;        clientSocket.sendMessage(new PickSecretObjectiveMessage(clientSocket.getUsername(), (Integer) rectangle.getUserData()));</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Method to handle the click on the gold pick
&nbsp;     *
&nbsp;     * @param event the mouse event
&nbsp;     */
&nbsp;    public void onDrawGoldPick(MouseEvent event) {
<b class="nc">&nbsp;        Rectangle rectangle = (Rectangle) event.getSource();</b>
<b class="nc">&nbsp;        Integer pick = (Integer) rectangle.getUserData();</b>
<b class="nc">&nbsp;        clientSocket.sendMessage(new PickGoldCardMessage(clientSocket.getUsername(), pick));</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Method to handle the click on the resource pick
&nbsp;     *
&nbsp;     * @param event the mouse event
&nbsp;     */
&nbsp;    public void onDrawResourcePick(MouseEvent event) {
<b class="nc">&nbsp;        Rectangle rectangle = (Rectangle) event.getSource();</b>
<b class="nc">&nbsp;        Integer pick = (Integer) rectangle.getUserData();</b>
<b class="nc">&nbsp;        clientSocket.sendMessage(new PickResourceCardMessage(clientSocket.getUsername(), pick));</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Method to handle the click on the hand
&nbsp;     *
&nbsp;     * @param event the mouse event
&nbsp;     */
&nbsp;    public void onSelectCardClick(MouseEvent event) {
<b class="nc">&nbsp;        if (this.selectedRectangle != null) {</b>
<b class="nc">&nbsp;            this.selectedRectangle.setEffect(new Glow(0));</b>
&nbsp;        }
&nbsp;        Card correspondingCard;
<b class="nc">&nbsp;        Rectangle clickedRectangle = (Rectangle) event.getSource();</b>
<b class="nc">&nbsp;        this.selectedRectangle = clickedRectangle;</b>
<b class="nc">&nbsp;        clickedRectangle.setEffect(new Glow(0.5));</b>
<b class="nc">&nbsp;        if (hand.containsKey(clickedRectangle)) {</b>
<b class="nc">&nbsp;            correspondingCard = hand.get(clickedRectangle);</b>
<b class="nc">&nbsp;            this.selectedCard = correspondingCard;</b>
&nbsp;        }
<b class="nc">&nbsp;        if (initialCardDisplay.containsKey(clickedRectangle)) {</b>
<b class="nc">&nbsp;            correspondingCard = initialCardDisplay.get(clickedRectangle);</b>
<b class="nc">&nbsp;            this.selectedCard = correspondingCard;</b>
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Method to update the points
&nbsp;     *
&nbsp;     * @param points the points
&nbsp;     */
&nbsp;    @Override
&nbsp;    public void updatePoints(ArrayList&lt;Integer&gt; points) {
<b class="nc">&nbsp;        for (int i = 0; i &lt; points.size(); i++) {</b>
<b class="nc">&nbsp;            Rectangle rectangle = (Rectangle) pointsDisplay.keySet().toArray()[i];</b>
<b class="nc">&nbsp;            Integer point = points.get(i);</b>
<b class="nc">&nbsp;            Platform.runLater(() -&gt; drawPoints(rectangle, point));</b>
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Method to update the chat
&nbsp;     *
&nbsp;     * @param message the message
&nbsp;     */
&nbsp;    @Override
&nbsp;    public void updateChat(String message) {
<b class="nc">&nbsp;        Platform.runLater(()-&gt; guiView.getChatText().appendText(message));</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * print utility method (not in use in GUI mode)
&nbsp;     * @param string string to print
&nbsp;     */
&nbsp;    @Override
&nbsp;    public void print(String string) {
&nbsp;
<b class="nc">&nbsp;    }</b>
&nbsp;
&nbsp;    @Override
&nbsp;    public void showWinners(String winner) {
<b class="nc">&nbsp;        Platform.runLater(()-&gt;{</b>
<b class="nc">&nbsp;            guiView.drawWinnerScene();</b>
<b class="nc">&nbsp;            guiView.setWinnerLabel(winner);</b>
&nbsp;        });
&nbsp;    }
&nbsp;
&nbsp;
&nbsp;    /**
&nbsp;     * sets the point text on the board
&nbsp;     * @param rectangle the rectangle containing the points
&nbsp;     * @param point the points to display
&nbsp;     */
&nbsp;    public void drawPoints(Rectangle rectangle, Integer point) {
<b class="nc">&nbsp;        Text text = pointsDisplay.get(rectangle);</b>
<b class="nc">&nbsp;        text.setText(point.toString());</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * sets the image to a rectangle on the board view
&nbsp;     * @param imagePath the file path to the image
&nbsp;     * @param rectangle the rectangle to set the image to
&nbsp;     * @throws FileNotFoundException if the file is not found
&nbsp;     */
&nbsp;    public void setImageToRectangle(String imagePath, Rectangle rectangle) throws FileNotFoundException {
<b class="nc">&nbsp;        InputStream is = getClass().getResourceAsStream(imagePath);</b>
<b class="nc">&nbsp;        assert is != null;</b>
<b class="nc">&nbsp;        Image image = new Image(is);</b>
<b class="nc">&nbsp;        ImagePattern imagePattern = new ImagePattern(image);</b>
<b class="nc">&nbsp;        rectangle.setFill(imagePattern);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * adds a gold card to the map
&nbsp;     *
&nbsp;     * @param rectangle the rectangle to set the image to
&nbsp;     * @param card the card
&nbsp;     * @throws FileNotFoundException if the file is not found
&nbsp;     */
&nbsp;    public void drawDrawableGold(Rectangle rectangle, Card card) throws FileNotFoundException {
<b class="nc">&nbsp;        if(card != null){</b>
<b class="nc">&nbsp;            String imagePath =loadImagePath(card);</b>
<b class="nc">&nbsp;            setImageToRectangle(imagePath, rectangle);</b>
<b class="nc">&nbsp;            drawableGold.put(rectangle, card);</b>
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;
&nbsp;    /**
&nbsp;     * adds a resource card to the map
&nbsp;     * @param rectangle the rectangle to set the image to
&nbsp;     * @param card the card
&nbsp;     * @throws FileNotFoundException if the file is not found
&nbsp;     */
&nbsp;    public void drawDrawableResource(Rectangle rectangle, Card card) throws FileNotFoundException {
<b class="nc">&nbsp;        if(card != null) {</b>
<b class="nc">&nbsp;            String imagePath =loadImagePath(card);</b>
<b class="nc">&nbsp;            setImageToRectangle(imagePath, rectangle);</b>
<b class="nc">&nbsp;            drawableResources.put(rectangle, card);</b>
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * method to draw the common objectives
&nbsp;     *
&nbsp;     * @param rectangle the rectangle
&nbsp;     * @param card the card
&nbsp;     * @throws FileNotFoundException if the file is not found
&nbsp;     */
&nbsp;    public void drawCommonObjectives(Rectangle rectangle, Card card) throws FileNotFoundException {
<b class="nc">&nbsp;        String imagePath =loadImagePath(card);</b>
<b class="nc">&nbsp;        setImageToRectangle(imagePath, rectangle);</b>
<b class="nc">&nbsp;        commonObjectives.put(rectangle, card);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * method to draw card images in hand
&nbsp;     * @param rectangle the rectangle containing the card in hand
&nbsp;     * @param card the card
&nbsp;     * @throws FileNotFoundException if the file is not found
&nbsp;     */
&nbsp;    public void drawHand(Rectangle rectangle, Card card) throws FileNotFoundException {
<b class="nc">&nbsp;        String imagePath =loadImagePath(card);</b>
<b class="nc">&nbsp;        setImageToRectangle(imagePath, rectangle);</b>
<b class="nc">&nbsp;        hand.put(rectangle, card);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * method to draw the initial card display
&nbsp;     * @param rectangle the rectangle to set the image to
&nbsp;     * @param card the card
&nbsp;     * @throws FileNotFoundException if the file is not found
&nbsp;     */
&nbsp;    public void drawInitialCardDisplay(Rectangle rectangle, Card card) throws FileNotFoundException {
<b class="nc">&nbsp;        String imagePath =loadImagePath(card);</b>
<b class="nc">&nbsp;        setImageToRectangle(imagePath, rectangle);</b>
<b class="nc">&nbsp;        initialCardDisplay.put(rectangle, card);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * method to draw the secret objective
&nbsp;     * @param rectangle the rectangle to set the image to
&nbsp;     * @param card the card
&nbsp;     * @throws FileNotFoundException if the file is not found
&nbsp;     */
&nbsp;    public void drawSecretObjective(Rectangle rectangle, Card card) throws FileNotFoundException {
<b class="nc">&nbsp;        Rectangle toDisable1 = (Rectangle) secretObjectivesToChoose.keySet().toArray()[0];</b>
<b class="nc">&nbsp;        Rectangle toDisable2 = (Rectangle) secretObjectivesToChoose.keySet().toArray()[1];</b>
<b class="nc">&nbsp;        this.disableRectangle(toDisable1);</b>
<b class="nc">&nbsp;        this.disableRectangle(toDisable2);</b>
<b class="nc">&nbsp;        this.disableRectangle(guiView.getSecretObjectiveBackground());</b>
&nbsp;
<b class="nc">&nbsp;        String imagePath =loadImagePath(card);</b>
<b class="nc">&nbsp;        setImageToRectangle(imagePath, rectangle);</b>
<b class="nc">&nbsp;        secretObjective.put(rectangle, card);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * method to draw the secret objectives to choose
&nbsp;     * @param rectangle the rectangle to set the image to
&nbsp;     * @param card the card
&nbsp;     * @throws FileNotFoundException if the file is not found
&nbsp;     */
&nbsp;    public void drawSecretObjectivesToChoose(Rectangle rectangle, Card card) throws FileNotFoundException {
<b class="nc">&nbsp;        String imagePath =loadImagePath(card);</b>
<b class="nc">&nbsp;        setImageToRectangle(imagePath, rectangle);</b>
&nbsp;
<b class="nc">&nbsp;        secretObjectivesToChoose.put(rectangle, card);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * method to draw a generic card placed on the board
&nbsp;     * @param rectangle the rectangle to set the image to
&nbsp;     * @param card the card
&nbsp;     * @throws FileNotFoundException if the file is not found
&nbsp;     */
&nbsp;    public void drawGenericCard(Rectangle rectangle, Card card) throws FileNotFoundException {
<b class="nc">&nbsp;        String imagePath =loadImagePath(card);</b>
<b class="nc">&nbsp;        setImageToRectangle(imagePath, rectangle);</b>
&nbsp;
<b class="nc">&nbsp;        if (initialCardDisplay.containsKey(selectedRectangle)) {</b>
<b class="nc">&nbsp;            initialCardDisplay.put(rectangle, card);</b>
&nbsp;        }
&nbsp;
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * method to compose the image path of a card based on its side and id
&nbsp;     * @param card the card
&nbsp;     * @return the image path to the showing side of the card
&nbsp;     */
&nbsp;    private String loadImagePath(Card card){
&nbsp;        String imagePath;
<b class="nc">&nbsp;        if (card.isShowingFront()) {</b>
<b class="nc">&nbsp;            imagePath = &quot;/cards_images/CODEX_cards_front/card_front_&quot; + card.getID() + &quot;.png&quot;;</b>
&nbsp;        } else {
<b class="nc">&nbsp;            imagePath = &quot;/cards_images/CODEX_cards_back/card_back_&quot; + card.getID() + &quot;.png&quot;;</b>
&nbsp;        }
<b class="nc">&nbsp;        return imagePath;</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * method to add a rectangle to the grid map
&nbsp;     *
&nbsp;     * @param rectangle the rectangle to add to the map
&nbsp;     */
&nbsp;    public void addRectangleToGridMap(Rectangle rectangle) {
<b class="nc">&nbsp;        rectangle.setOnMouseClicked(this::onGridClick);</b>
<b class="nc">&nbsp;        gridMap.put(rectangle, null);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * method to add a rectangle to the secret objectives to choose map
&nbsp;     * @param rectangle the rectangle to add to the map
&nbsp;     */
&nbsp;    public void addRectangleToSecretObjectivesToChoose(Rectangle rectangle) {
<b class="nc">&nbsp;        rectangle.setOnContextMenuRequested(this::onSecretObjectivePick);</b>
<b class="nc">&nbsp;        secretObjectivesToChoose.put(rectangle, null);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * method to add a rectangle to the initial card display map
&nbsp;     * @param rectangle the rectangle to add to the map
&nbsp;     */
&nbsp;    public void addRectangleToInitialCardDisplay(Rectangle rectangle) {
<b class="nc">&nbsp;        rectangle.setOnMouseClicked(this::onSelectCardClick);</b>
<b class="nc">&nbsp;        rectangle.setOnContextMenuRequested(this::onInitialCardSelection);</b>
<b class="nc">&nbsp;        initialCardDisplay.put(rectangle, null);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * method to add a rectangle to the points display map
&nbsp;     * @param rectangle the rectangle to add to the map
&nbsp;     * @param text the text to display
&nbsp;     */
&nbsp;    public void addRectangleToPointsDisplay(Rectangle rectangle, Text text) {
<b class="nc">&nbsp;        pointsDisplay.put(rectangle, text);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * method to add a rectangle to the drawable gold map
&nbsp;     *
&nbsp;     * @param rectangle the rectangle to add to the map
&nbsp;     */
&nbsp;    public void addRectangleToDrawableGoldMap(Rectangle rectangle) {
<b class="nc">&nbsp;        rectangle.setOnMouseClicked(this::onDrawGoldPick);</b>
<b class="nc">&nbsp;        drawableGold.put(rectangle, null);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * method to add a rectangle to the drawable resources map
&nbsp;     *
&nbsp;     * @param rectangle the rectangle to add to the map
&nbsp;     */
&nbsp;    public void addRectangleToDrawableResourcesMap(Rectangle rectangle) {
<b class="nc">&nbsp;        rectangle.setOnMouseClicked(this::onDrawResourcePick);</b>
<b class="nc">&nbsp;        drawableResources.put(rectangle, null);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * method to add a rectangle to the hand map
&nbsp;     *
&nbsp;     * @param rectangle the rectangle to add to the map
&nbsp;     */
&nbsp;    public void addRectangleToHandMap(Rectangle rectangle) {
<b class="nc">&nbsp;        rectangle.setOnMouseClicked(this::onSelectCardClick);</b>
<b class="nc">&nbsp;        hand.put(rectangle, null);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * method to add a rectangle to the common objectives map
&nbsp;     *
&nbsp;     * @param rectangle the rectangle to add to the map
&nbsp;     */
&nbsp;    public void addRectangleToCommonObjectivesMap(Rectangle rectangle) {
<b class="nc">&nbsp;        commonObjectives.put(rectangle, null);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * method to add a rectangle to the secret objectives map
&nbsp;     *
&nbsp;     * @param rectangle the rectangle to add to the map
&nbsp;     */
&nbsp;    public void addRectangleToSecretObjectiveMap(Rectangle rectangle) {
<b class="nc">&nbsp;        secretObjective.put(rectangle, null);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * method to disable a rectangle and make it invisible
&nbsp;     * @param rectangle the rectangle to disable
&nbsp;     */
&nbsp;    public void disableRectangle(Rectangle rectangle) {
<b class="nc">&nbsp;        rectangle.setOpacity(0);</b>
<b class="nc">&nbsp;        rectangle.setHeight(0);</b>
<b class="nc">&nbsp;        rectangle.setWidth(0);</b>
<b class="nc">&nbsp;        rectangle.setDisable(true);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * sets up the drawable gold card rectangles
&nbsp;     *
&nbsp;     * @param Top the top rectangle
&nbsp;     * @param mid the middle rectangle
&nbsp;     * @param bottom the bottom rectangle
&nbsp;     */
&nbsp;    public void setUpDrawableGold(Rectangle Top, Rectangle mid, Rectangle bottom) {
<b class="nc">&nbsp;        addRectangleToDrawableGoldMap(Top);</b>
<b class="nc">&nbsp;        addRectangleToDrawableGoldMap(mid);</b>
<b class="nc">&nbsp;        addRectangleToDrawableGoldMap(bottom);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * sets up the drawable resources
&nbsp;     *
&nbsp;     * @param top the top rectangle
&nbsp;     * @param mid the middle rectangle
&nbsp;     * @param bottom the bottom rectangle
&nbsp;     */
&nbsp;    public void setUpDrawableResources(Rectangle top, Rectangle mid, Rectangle bottom) {
<b class="nc">&nbsp;        addRectangleToDrawableResourcesMap(top);</b>
<b class="nc">&nbsp;        addRectangleToDrawableResourcesMap(mid);</b>
<b class="nc">&nbsp;        addRectangleToDrawableResourcesMap(bottom);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * sets up the secret objectives to choose rectangles
&nbsp;     * @param top the top rectangle
&nbsp;     * @param bottom the bottom rectangle
&nbsp;     */
&nbsp;    public void setUpSecretObjectivesToChoose(Rectangle top, Rectangle bottom) {
<b class="nc">&nbsp;        addRectangleToSecretObjectivesToChoose(top);</b>
<b class="nc">&nbsp;        addRectangleToSecretObjectivesToChoose(bottom);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * sets up the initial card rectangle
&nbsp;     * @param initialCardRectangle the rectangle that will display the initial card
&nbsp;     */
&nbsp;    public void setUpInitialCardDisplay(Rectangle initialCardRectangle) {
<b class="nc">&nbsp;        addRectangleToInitialCardDisplay(initialCardRectangle);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * sets up the hand map
&nbsp;     *
&nbsp;     * @param hand1 the first rectangle
&nbsp;     * @param hand2 the second rectangle
&nbsp;     * @param hand3 the third rectangle
&nbsp;     */
&nbsp;    public void setUpHandMap(Rectangle hand1, Rectangle hand2, Rectangle hand3) {
<b class="nc">&nbsp;        addRectangleToHandMap(hand1);</b>
<b class="nc">&nbsp;        addRectangleToHandMap(hand2);</b>
<b class="nc">&nbsp;        addRectangleToHandMap(hand3);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * sets up the common objectives map
&nbsp;     *
&nbsp;     * @param common1 the first rectangle
&nbsp;     * @param common2 the second rectangle
&nbsp;     */
&nbsp;    public void setUpCommonObjectivesMap(Rectangle common1, Rectangle common2) {
<b class="nc">&nbsp;        addRectangleToCommonObjectivesMap(common1);</b>
<b class="nc">&nbsp;        addRectangleToCommonObjectivesMap(common2);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * sets up the secret objectives map
&nbsp;     *
&nbsp;     * @param secret the rectangle
&nbsp;     */
&nbsp;    public void setSecretObjectiveMap(Rectangle secret) {
<b class="nc">&nbsp;        addRectangleToSecretObjectiveMap(secret);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * method to flip a card in hand or in the initial card display
&nbsp;     * @throws FileNotFoundException if the file for the card face is not found
&nbsp;     */
&nbsp;    public void flipCard() throws FileNotFoundException {
<b class="nc">&nbsp;        if (this.selectedCard != null &amp;&amp; this.selectedRectangle != null) {</b>
<b class="nc">&nbsp;            if (hand.containsKey(selectedRectangle) || initialCardDisplay.containsKey(selectedRectangle)) {</b>
<b class="nc">&nbsp;                this.selectedCard.flip();</b>
<b class="nc">&nbsp;                drawGenericCard(this.selectedRectangle, this.selectedCard);</b>
&nbsp;            }
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * method to reset the board scene controller
&nbsp;     */
&nbsp;    public void reset(){
<b class="nc">&nbsp;        this.gridMap = new HashMap&lt;&gt;();</b>
<b class="nc">&nbsp;        this.drawableResources = new LinkedHashMap&lt;&gt;();</b>
<b class="nc">&nbsp;        this.hand = new LinkedHashMap&lt;&gt;();</b>
<b class="nc">&nbsp;        this.drawableGold = new LinkedHashMap&lt;&gt;();</b>
<b class="nc">&nbsp;        this.commonObjectives = new LinkedHashMap&lt;&gt;();</b>
<b class="nc">&nbsp;        this.secretObjectivesToChoose = new LinkedHashMap&lt;&gt;();</b>
<b class="nc">&nbsp;        this.secretObjective = new LinkedHashMap&lt;&gt;();</b>
<b class="nc">&nbsp;        this.initialCardDisplay = new LinkedHashMap&lt;&gt;();</b>
<b class="nc">&nbsp;        this.pointsDisplay = new LinkedHashMap&lt;&gt;();</b>
&nbsp;    }
&nbsp;
&nbsp;    //SETTER
&nbsp;
&nbsp;    public void setClientSocket(ClientSocket clientSocket) {
<b class="nc">&nbsp;        this.clientSocket = clientSocket;</b>
&nbsp;    }
&nbsp;
&nbsp;}
</code>
</pre>
</div>

<script type="text/javascript">
(function() {
    var msie = false, msie9 = false;
    /*@cc_on
      msie = true;
      @if (@_jscript_version >= 9)
        msie9 = true;
      @end
    @*/

    if (!msie || msie && msie9) {
      hljs.highlightAll()
      hljs.initLineNumbersOnLoad();
    }
})();
</script>

<div class="footer">
    
    <div style="float:right;">generated on 2024-05-27 12:25</div>
</div>
</body>
</html>
